
// Enhanced translation mappings for comprehensive CV translations
const translations: { [key: string]: { de: string; en: string } } = {
  // Personal Info - Complete phrases
  'Leidenschaftlicher Frontend-Entwickler mit 5+ Jahren Erfahrung in React, TypeScript und modernen Web-Technologies. Spezialisiert auf responsive Design und Performance-Optimierung.': {
    de: 'Leidenschaftlicher Frontend-Entwickler mit 5+ Jahren Erfahrung in React, TypeScript und modernen Web-Technologies. Spezialisiert auf responsive Design und Performance-Optimierung.',
    en: 'Passionate Frontend Developer with 5+ years of experience in React, TypeScript and modern web technologies. Specialized in responsive design and performance optimization.'
  },
  'Leidenschaftlicher Frontend-Entwickler': { de: 'Leidenschaftlicher Frontend-Entwickler', en: 'Passionate Frontend Developer' },
  'mit 5+ Jahren Erfahrung': { de: 'mit 5+ Jahren Erfahrung', en: 'with 5+ years of experience' },
  'in React, TypeScript und modernen Web-Technologies': { de: 'in React, TypeScript und modernen Web-Technologies', en: 'in React, TypeScript and modern web technologies' },
  'Spezialisiert auf responsive Design und Performance-Optimierung': { de: 'Spezialisiert auf responsive Design und Performance-Optimierung', en: 'Specialized in responsive design and performance optimization' },
  
  // Names
  'Max Mustermann': { de: 'Max Mustermann', en: 'Max Mustermann' },
  'Marcel Test Test': { de: 'Marcel Test Test', en: 'Marcel Test Test' },
  
  // Positions
  'Senior Frontend Developer': { de: 'Senior Frontend Developer', en: 'Senior Frontend Developer' },
  'Frontend Developer': { de: 'Frontend Developer', en: 'Frontend Developer' },
  
  // Locations
  'Berlin, Deutschland': { de: 'Berlin, Deutschland', en: 'Berlin, Germany' },
  'Deutschland': { de: 'Deutschland', en: 'Germany' },
  
  // Experience descriptions
  'Entwicklung und Wartung von React-Anwendungen für Enterprise-Kunden. Implementierung von Design-Systemen und Performance-Optimierungen.': {
    de: 'Entwicklung und Wartung von React-Anwendungen für Enterprise-Kunden. Implementierung von Design-Systemen und Performance-Optimierungen.',
    en: 'Development and maintenance of React applications for enterprise clients. Implementation of design systems and performance optimizations.'
  },
  'Erstellung responsiver Websites und Web-Anwendungen. Zusammenarbeit mit Design- und Backend-Teams in agilen Entwicklungsprozessen.': {
    de: 'Erstellung responsiver Websites und Web-Anwendungen. Zusammenarbeit mit Design- und Backend-Teams in agilen Entwicklungsprozessen.',
    en: 'Creation of responsive websites and web applications. Collaboration with design and backend teams in agile development processes.'
  },
  
  // Education
  'Technische Universität Berlin': { de: 'Technische Universität Berlin', en: 'Technical University Berlin' },
  'Bachelor of Science - Informatik': { de: 'Bachelor of Science - Informatik', en: 'Bachelor of Science - Computer Science' },
  'Schwerpunkt: Web-Entwicklung und Software Engineering. Abschlussnote: 1,5': {
    de: 'Schwerpunkt: Web-Entwicklung und Software Engineering. Abschlussnote: 1,5',
    en: 'Focus: Web Development and Software Engineering. Final grade: 1.5'
  },
  
  // Time periods
  'Heute': { de: 'Heute', en: 'Present' },
  '2022 - Heute': { de: '2022 - Heute', en: '2022 - Present' },
  
  // Languages
  'Deutsch': { de: 'Deutsch', en: 'German' },
  'Englisch': { de: 'Englisch', en: 'English' },
  'Französisch': { de: 'Französisch', en: 'French' },
  'Muttersprache': { de: 'Muttersprache', en: 'Native' },
  'Fließend (C1)': { de: 'Fließend (C1)', en: 'Fluent (C1)' },
  'Grundkenntnisse (A2)': { de: 'Grundkenntnisse (A2)', en: 'Basic (A2)' },
  
  // Projects
  'Vollständiges Dashboard für Online-Shop-Verwaltung mit React und TypeScript': {
    de: 'Vollständiges Dashboard für Online-Shop-Verwaltung mit React und TypeScript',
    en: 'Complete dashboard for online shop management with React and TypeScript'
  },
  'Responsive Portfolio-Website mit modernem Design und Animationen': {
    de: 'Responsive Portfolio-Website mit modernem Design und Animationen',
    en: 'Responsive portfolio website with modern design and animations'
  },
  
  // Certificates
  'März 2023': { de: 'März 2023', en: 'March 2023' },
  'März 2026': { de: 'März 2026', en: 'March 2026' },
  'Januar 2023': { de: 'Januar 2023', en: 'January 2023' },
  'Amazon Web Services': { de: 'Amazon Web Services', en: 'Amazon Web Services' },
  'Google': { de: 'Google', en: 'Google' }
};

// Enhanced word-by-word translation for better coverage
const wordTranslations: { [key: string]: { de: string; en: string } } = {
  // Common words
  'mit': { de: 'mit', en: 'with' },
  'und': { de: 'und', en: 'and' },
  'in': { de: 'in', en: 'in' },
  'auf': { de: 'auf', en: 'on' },
  'für': { de: 'für', en: 'for' },
  'von': { de: 'von', en: 'of' },
  'Jahren': { de: 'Jahren', en: 'years' },
  'Erfahrung': { de: 'Erfahrung', en: 'experience' },
  'modernen': { de: 'modernen', en: 'modern' },
  'Spezialisiert': { de: 'Spezialisiert', en: 'Specialized' },
  'responsive': { de: 'responsive', en: 'responsive' },
  'Design': { de: 'Design', en: 'design' },
  'Performance-Optimierung': { de: 'Performance-Optimierung', en: 'performance optimization' },
  'Web-Technologies': { de: 'Web-Technologies', en: 'web technologies' },
  'Leidenschaftlicher': { de: 'Leidenschaftlicher', en: 'Passionate' },
  'Entwicklung': { de: 'Entwicklung', en: 'Development' },
  'Wartung': { de: 'Wartung', en: 'maintenance' },
  'Implementierung': { de: 'Implementierung', en: 'Implementation' },
  'Erstellung': { de: 'Erstellung', en: 'Creation' },
  'Zusammenarbeit': { de: 'Zusammenarbeit', en: 'Collaboration' },
  'Schwerpunkt': { de: 'Schwerpunkt', en: 'Focus' },
  'Abschlussnote': { de: 'Abschlussnote', en: 'Final grade' },
  'Vollständiges': { de: 'Vollständiges', en: 'Complete' },
  'Dashboard': { de: 'Dashboard', en: 'dashboard' },
  'Online-Shop-Verwaltung': { de: 'Online-Shop-Verwaltung', en: 'online shop management' },
  'Portfolio-Website': { de: 'Portfolio-Website', en: 'portfolio website' },
  'Animationen': { de: 'Animationen', en: 'animations' }
};

// Smart translation function that handles sentences and phrases intelligently
export const translateText = (text: string, fromLang: 'de' | 'en', toLang: 'de' | 'en'): string => {
  if (fromLang === toLang) return text;
  
  console.log(`Translating: "${text}" from ${fromLang} to ${toLang}`);
  
  // Try to find exact matches first (complete sentences/phrases)
  for (const [key, value] of Object.entries(translations)) {
    if (value[fromLang] === text.trim()) {
      console.log(`Found exact match: ${value[toLang]}`);
      return value[toLang];
    }
  }
  
  // Try partial matches for longer texts (sentence fragments)
  let translatedText = text;
  let hasTranslation = false;
  
  // Sort by length (longest first) to prioritize longer phrases
  const sortedTranslations = Object.entries(translations).sort((a, b) => 
    b[1][fromLang].length - a[1][fromLang].length
  );
  
  for (const [key, value] of sortedTranslations) {
    if (text.includes(value[fromLang])) {
      translatedText = translatedText.replace(value[fromLang], value[toLang]);
      hasTranslation = true;
      console.log(`Applied phrase translation: ${value[fromLang]} -> ${value[toLang]}`);
    }
  }
  
  // If no phrase matches found, try word-by-word translation
  if (!hasTranslation) {
    console.log('No phrase matches found, trying word-by-word translation');
    const words = text.split(/(\s+|[.,;:!?()+-])/);
    const translatedWords = words.map(word => {
      const cleanWord = word.trim();
      if (!cleanWord || /^[\s.,;:!?()+-]+$/.test(word)) {
        return word; // Keep punctuation and spaces as is
      }
      
      for (const [key, value] of Object.entries(wordTranslations)) {
        if (value[fromLang] === cleanWord) {
          console.log(`Word translation: ${cleanWord} -> ${value[toLang]}`);
          return value[toLang];
        }
      }
      
      return word; // Return original if no translation found
    });
    
    translatedText = translatedWords.join('');
  }
  
  console.log(`Translation result: "${translatedText}"`);
  return translatedText;
};

export const translateCVData = (data: any, fromLang: 'de' | 'en', toLang: 'de' | 'en'): any => {
  if (fromLang === toLang) return data;
  
  const translateObject = (obj: any): any => {
    if (typeof obj === 'string') {
      return translateText(obj, fromLang, toLang);
    }
    
    if (Array.isArray(obj)) {
      return obj.map(translateObject);
    }
    
    if (obj && typeof obj === 'object') {
      const translated: any = {};
      for (const [key, value] of Object.entries(obj)) {
        translated[key] = translateObject(value);
      }
      return translated;
    }
    
    return obj;
  };
  
  return translateObject(data);
};
